# ============================================================================
# NVIDIA Riva Conformer-CTC Streaming ASR Configuration
# ============================================================================
# Copy this file to .env and fill in your values:
# cp .env.example .env
# ============================================================================

# ============================================================================
# AWS Configuration
# ============================================================================
AWS_REGION=us-east-2
AWS_ACCOUNT_ID=YOUR_AWS_ACCOUNT_ID
GPU_INSTANCE_TYPE=g4dn.xlarge
GPU_INSTANCE_ID=<will-be-set-after-deployment>
GPU_INSTANCE_IP=<will-be-set-after-deployment>
SSH_KEY_NAME=dbm-sep23-2025

# ============================================================================
# NVIDIA NGC (Required for Model Downloads)
# ============================================================================
# Get your free API key from: https://ngc.nvidia.com
# Click "Generate API Key" after signing in
NGC_API_KEY=YOUR_NGC_API_KEY_HERE

# ============================================================================
# RIVA Server Configuration
# ============================================================================
RIVA_HOST=<will-be-set-after-gpu-deployment>
RIVA_PORT=50051
RIVA_HTTP_PORT=8000

# ============================================================================
# Model Configuration (Conformer-CTC Streaming)
# ============================================================================
# IMPORTANT: This is Conformer-CTC, NOT Parakeet RNNT
# Parakeet RNNT streaming is NOT supported in classic RIVA 2.19
RIVA_MODEL=conformer-ctc-xl-en-us-streaming-asr-bls-ensemble
RIVA_LANGUAGE_CODE=en-US
RIVA_ENABLE_AUTOMATIC_PUNCTUATION=true
RIVA_ENABLE_WORD_TIME_OFFSETS=true

# ============================================================================
# WebSocket Bridge Configuration (Build Box)
# ============================================================================
APP_HOST=0.0.0.0
APP_PORT=8443
APP_SSL_CERT=/opt/riva/certs/server.crt
APP_SSL_KEY=/opt/riva/certs/server.key

# ============================================================================
# HTTPS Demo Server
# ============================================================================
DEMO_PORT=8444
DEMO_SSL_CERT=/opt/riva/certs/server.crt
DEMO_SSL_KEY=/opt/riva/certs/server.key

# ============================================================================
# Streaming Parameters
# ============================================================================
RIVA_ENABLE_PARTIAL_RESULTS=true
RIVA_PARTIAL_RESULT_INTERVAL_MS=300
RIVA_CHUNK_SIZE_BYTES=3200

# ============================================================================
# S3 Model Locations (Pre-built RMIR)
# ============================================================================
S3_CONFORMER_RMIR=s3://dbm-cf-2-web/bintarball/riva-models/conformer/conformer-ctc-xl-streaming-40ms.rmir
S3_CONFORMER_SOURCE=s3://dbm-cf-2-web/bintarball/riva-models/conformer/Conformer-CTC-XL_spe-128_en-US_Riva-ASR-SET-4.0.riva
S3_CONFORMER_TRITON_CACHE=s3://dbm-cf-2-web/bintarball/riva-repository/conformer-ctc-xl/v1.0/

# ============================================================================
# Build & Deployment Optimizations (Scripts 100-102, 124, 125)
# ============================================================================
# REMOTE_SYNC: Set to 'true' to sync GPUâ†’S3 directly (skip SCP to build box)
# Requires GPU instance to have AWS IAM role with S3 write access
# Default: false (use traditional SCP transfer method)
REMOTE_SYNC=false

# GOLDEN_WAV_S3: Optional S3 path to validation audio for script 124
# Used to smoke-test Triton models before uploading to S3 cache
# Should be 16kHz mono PCM WAV, 3-5 seconds duration
# Leave empty to skip validation test
GOLDEN_WAV_S3=

# ============================================================================
# Security Group Configuration
# ============================================================================
# These are auto-populated by 030-configure-security-groups.sh
SECURITY_GROUP_ID=<will-be-set-during-setup>
BUILDBOX_SECURITY_GROUP=<will-be-set-during-setup>

# Optional: Override default ports (comma-separated)
# GPU_SG_PORTS=22,50051,8000
# GPU_SG_PORT_DESCRIPTIONS="SSH,Riva gRPC,Riva HTTP/Health"
# BUILDBOX_SG_PORTS=22,8443,8444
# BUILDBOX_SG_PORT_DESCRIPTIONS="SSH,WebSocket Bridge (WSS),HTTPS Demo Server"
# BUILDBOX_SG_PUBLIC_PORTS=8443,8444

# ============================================================================
# Deployment Info
# ============================================================================
DEPLOYMENT_STRATEGY=conformer-ctc-streaming
DEPLOYMENT_TIMESTAMP=<will-be-set-during-deployment>
